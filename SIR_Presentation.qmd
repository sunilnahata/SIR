---
title: "Simulating the Monty Hall Problem"
author: 
  - name: "Arsid MASHI"
  - name: "Sunil NAHATA" 
date: "`r format(Sys.Date(), '%B %d, %Y')`"
format:
  revealjs:
    slide-number: true
    logo: logo.png
    code-block-borders: true
    center-title-slide: false      # stop vertical centering
    title-slide-style: default     # use Quarto title slide
    width: 1400     # or e.g. 1400
    height: 900      # taller than default 700
    pointer:
      pointerSize: 18
      color: 'blue'
revealjs-plugins:
  - pointer
css: style.css
execute:
  echo: true
  warning: false
  message: false
title-slide-attributes:
  data-background-image: millionaire_background.jpeg
  data-background-size: full
  data-background-opacity: "1.0"
---

# Overview

::: incremental
-   What is the game all about?
-   Simulation (in R)
-   Results (1000 simulations per strategy)
-   Intuition vs Math
-   Conclusion
:::

# Rules of the game {background-image="slide_1.png"}

# Rules of the game {background-image="slide_2.png"}

# Rules of the game {background-image="slide_3.png"}

# Rules of the game {background-image="slide_4.png"}

# Rules of the game

Player then chooses: - **No exchange** - **Exchange** - **Random choice**

Goal: maximize expected winnings

# Why is this interesting?
::: {.incremental}
-   Intuition: "Two boxes left → 50/50"\
-   Reality: conditional probability changes the situation\
-   We'll test by simulation (1000 runs per strategy)
:::

# Simulation 

We simulate three functions (*no exchange*, *exchange*, *random choice*). 

::: {.incremental}
-   Create boxes `c(1, 1, 1,000,000)` placed randomly
-   Player makes an initial uniform random pick
-   Host opens a dime box among the remaining
-   Player applies a strategy to pick final box
-   Repeat N times and compute mean winnings
:::

# No Exchange

```{r}
#| code-line-numbers: "|4-8"

# Player chooses a box and sticks with his choice

game_no_box_change = function(){  
  box = c(1, 1, 1000000)  
  random_choice = sample(1:3, size= 1) 
  chosen_box = box[random_choice] 
  remaining_boxes = box[-random_choice] 
  return(chosen_box)  
}

```

# Always exchange

```{r}
#| code-line-numbers: "|4-9"

# Of the two remaining boxes, the presenter opens a box containing a dime 

game_box_exchange = function(){
  boxes <- c(1000000, 1, 1)
  pick <- sample(1:3, 1)
  remaining <- setdiff(1:3, pick)
  presenter <- remaining[boxes[remaining] == 1][1]
  final_choice <- setdiff(remaining, presenter)
  return(boxes[final_choice])
}

```

# Random choice

```{r}
#| code-line-numbers: "|4-6"

# Player chooses to keep the box chosen at the beginning or switch to the remaining box, a random choice

game_random_remain_pick = function(){   
  random_choice = sample(1:2, size= 1)    
  if (random_choice == 1) {game_box_exchange()}
  else {game_no_box_change()}
}
```



# 1000 simulations per strategy

```{r}
#| code-line-numbers: "|3|5-7|9-13"

# Repeat 1000 games

N <- 1000

mean_game_no_box_change <- mean(replicate(N, game_no_box_change()))
mean_game_random_remain_pick <- mean(replicate(N, game_random_remain_pick()))
mean_game_box_exchange <- mean(replicate(N, game_box_exchange()))

means <- c("No Exchange" = mean_game_no_box_change,
              "Random" = mean_game_random_remain_pick,
              "Exchange" = mean_game_box_exchange)

means
```

# Results — Mean Winnings {.fragments}

```{r}
#| echo: false
#| fig-height: 5
#| fig-align: center


library(ggplot2)
df_means <- data.frame(
  Strategy = factor(names(means), levels = names(means)),
  Mean     = as.numeric(means)
)

ggplot(df_means, aes(x = Strategy, y = Mean, fill = Strategy)) +
  geom_col(color = "black") +
  geom_text(aes(label = round(Mean)), vjust = -0.5, size = 5) +
  scale_fill_manual(values = c("No Exchange" = "#CD7F32",
                               "Random"    = "#C0C0C0",
                               "Exchange"    = "#FFD700")) +
  scale_y_continuous(
    labels = function(x) format(x, scientific = FALSE, big.mark = ""),
    limits = c(0, max(df_means$Mean) * 1.1)
  ) +
  labs(
    title = "Results of 1000 Games per Strategy",
    y = "Mean winnings",
    x = NULL
  ) +
  theme(
    legend.position = "none",
    plot.title = element_text(size = 18, hjust = 0.5),
    axis.title.y = element_text(size = 20),
    axis.text.x  = element_text(size = 18),
    axis.text.y  = element_text(size = 16)
  )
```

# Interpretation

-   **No switch** ≈ 33%

-   **Random** ≈ 50%

-   **Switch** ≈ 66% ← Best strategy

-   **Switching boxes** increases the win probability by two times than 
**sticking** with the first choice.


# Why Random Choice = 50%

:::{.incremental}
- Random choice = half the time you switch, half the time you don’t
- Switching wins **2/3**
- Not switching wins **1/3**
- Average = 0.5×(2/3) + 0.5×(1/3) = **1/2**
:::

::: {.fragment}
$$
\text{Win probability of random choice}
= \frac{1}{2}\left(\frac{2}{3}\right)
+ \frac{1}{2}\left(\frac{1}{3}\right)
= \frac{1}{2}
$$
:::

# Why Switching Wins

$$
\scriptsize
\displaystyle
\begin{aligned}
P(B_{\text{initial}} = 1{,}000{,}000 \mid \text{host reveals 1}) 
&= \frac{
    P(\text{host reveals 1} \mid B_{\text{initial}} = 1{,}000{,}000) 
    \cdot P(B_{\text{initial}} = 1{,}000{,}000)
}{P(\text{host reveals 1})}
\end{aligned}
$$



$$
\scriptsize
\begin{align}
P(B_{\text{initial}} = 1{,}000{,}000) &= \frac{1}{3} \\
P(\text{host reveals 1} \mid B_{\text{initial}} = 1{,}000{,}000) &= 1 \\
P(\text{host reveals 1}) &= 1 \\
P(B_{\text{initial}} = 1{,}000{,}000 \mid \text{host reveals 1}) &= \frac{1}{3} \\
P(\text{switch to other box}) &= \frac{2}{3}
\end{align}
$$


